var V=Object.defineProperty;var T=(e,s,t)=>s in e?V(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t;var p=(e,s,t)=>T(e,typeof s!="symbol"?s+"":s,t);import{s as L}from"./index-C6UZc7hI.js";import{s as O}from"./index-CWmb5psA.js";import{s as R}from"./index-CJ6tXHN-.js";import{B as F,b as B,C as N}from"./component-CWCFeeTt.js";import{A as u,U as E,n as S,_ as M,c as l,a as n,e as g,k as A,w as D,r as K,F as P,D as v,t as C,C as b,o as c,B as k}from"./index-D4TKg6Qf.js";var U=Object.defineProperty,Q=Object.getOwnPropertyDescriptor,y=(e,s,t,i)=>{for(var o=i>1?void 0:i?Q(s,t):s,r=e.length-1,d;r>=0;r--)(d=e[r])&&(o=(i?d(s,t,o):d(o))||o);return i&&o&&U(s,t,o),o};let j=class extends F{constructor(){super(...arguments);p(this,"appDropdownOpen",!1);p(this,"projectDropdownOpen",!1);p(this,"avatarDropdownOpen",!1);p(this,"searchTextApp","");p(this,"searchTextProject","");p(this,"isApplicationDetailsPage",!1);p(this,"isProjectStructuresPage",!1);p(this,"isApplicationSettingsPage",!1);p(this,"isDashboardsPage",!1);p(this,"isDataInsightsPage",!1);p(this,"isSavedWidgetsPage",!1);p(this,"projectsForCurrentApp",[]);p(this,"currentApp",null);p(this,"currentProject",null);p(this,"isLoadingProjects",!1);p(this,"isSwitchingApplication",!1)}mounted(){this.updateRouteState(),this.loadApplicationsIfNeeded(),u.currentApplication||this.tryAutoSelectAppAndProject(),document.addEventListener("click",this.handleClickOutside)}beforeUnmount(){document.removeEventListener("click",this.handleClickOutside)}get allApplications(){return u.allApplications}get filteredApplications(){return this.allApplications.filter(t=>t.id.toLowerCase().includes(this.searchTextApp.toLowerCase()))}get filteredProjects(){return this.projectsForCurrentApp.filter(t=>t.name.toLowerCase().includes(this.searchTextProject.toLowerCase()))}get currentAppName(){var t;return((t=this.currentApp)==null?void 0:t.id)||"Select Application"}get currentProjectName(){var t;return((t=this.currentProject)==null?void 0:t.name)||"Select Project"}onRouteChange(){this.updateRouteState(),u.currentApplication||this.tryAutoSelectAppAndProject()}onGlobalApplicationChange(){this.currentApp=u.currentApplication,this.currentApp&&!this.isSwitchingApplication&&this.loadProjectsForCurrentApp()}updateRouteState(){var i,o;const t=this.$route.path;if(this.isApplicationDetailsPage=/^\/application\/[^/]+$/.test(t),this.isProjectStructuresPage=/^\/application\/[^/]+\/project\/[^/]+\/structures$/.test(t),this.isApplicationSettingsPage=/^\/application\/[^/]+\/settings$/.test(t),this.isDashboardsPage=/^\/application\/[^/]+\/dashboards(\/.*)?$/.test(t),this.isDataInsightsPage=/^\/application\/[^/]+\/data-insights$/.test(t),this.isSavedWidgetsPage=/^\/application\/[^/]+\/saved-widgets$/.test(t),this.isApplicationDetailsPage||this.isProjectStructuresPage||this.isApplicationSettingsPage||this.isDashboardsPage||this.isDataInsightsPage||this.isSavedWidgetsPage){const r=this.$route.params.applicationId;r&&((i=this.currentApp)==null?void 0:i.id)!==r&&this.setActiveAppById(r)}if(this.isApplicationDetailsPage&&!this.isProjectStructuresPage)this.currentProject=null;else if(this.isProjectStructuresPage){const r=this.$route.params.projectId;r&&((o=this.currentProject)==null?void 0:o.id)!==r&&this.setCurrentProjectById(r)}else(this.isApplicationSettingsPage||this.isDashboardsPage||this.isDataInsightsPage||this.isSavedWidgetsPage)&&(this.currentProject=null)}loadApplicationsIfNeeded(){u.allApplications.length===0&&u.loadAllApplications()}toggleAppDropdown(){this.appDropdownOpen=!this.appDropdownOpen,this.appDropdownOpen&&(this.projectDropdownOpen=!1)}toggleProjectDropdown(){this.currentApp&&(this.projectDropdownOpen=!this.projectDropdownOpen,this.projectDropdownOpen&&(this.appDropdownOpen=!1),this.projectsForCurrentApp.length===0&&this.loadProjectsForCurrentApp())}toggleAvatarDropdown(){this.avatarDropdownOpen=!this.avatarDropdownOpen,this.avatarDropdownOpen&&(this.appDropdownOpen=!1,this.projectDropdownOpen=!1)}async handleLogout(){try{await E.logout(),this.$router.push("/login")}catch{this.$router.push("/login")}}async loadProjectsForCurrentApp(){var t;if(!(!this.currentApp||this.isLoadingProjects)){this.isLoadingProjects=!0;try{const i={pageNumber:0,pageSize:100},o=await S.getProjectService().findAllForApplication(this.currentApp.id,i);if(this.projectsForCurrentApp=o.content??[],this.isProjectStructuresPage){const r=this.$route.params.projectId,d=this.$route.params.applicationId;r&&d===this.currentApp.id&&((t=this.currentProject)==null?void 0:t.id)!==r&&this.setCurrentProjectById(r)}}catch{}finally{this.isLoadingProjects=!1}}}async selectApp(t){this.isSwitchingApplication=!0;try{this.currentApp=t,u.currentApplication=t,this.appDropdownOpen=!1,this.currentProject=null,this.projectsForCurrentApp=[],this.searchTextApp="",await this.$router.push(`/application/${encodeURIComponent(t.id)}`),await new Promise(i=>setTimeout(i,50)),await this.loadProjectsForCurrentApp(),this.$emit("application-changed",t)}finally{this.isSwitchingApplication=!1}}selectProject(t){var r;this.currentProject=t;const i=t.id??"",o=((r=this.currentApp)==null?void 0:r.id)??"";this.$router.push(`/application/${encodeURIComponent(o)}/project/${encodeURIComponent(i)}/structures`),this.projectDropdownOpen=!1,this.searchTextProject=""}async setActiveAppById(t){const i=this.allApplications.find(o=>o.id===t);i?(this.currentApp=i,u.currentApplication=i):setTimeout(()=>this.setActiveAppById(t),500)}async setActiveProjectById(t,i){try{const o=this.allApplications.find(r=>r.id===t);if(o){this.currentApp=o,u.currentApplication=o;const r={pageNumber:0,pageSize:100},d=await S.getProjectService().findAllForApplication(t,r);this.projectsForCurrentApp=d.content??[];const h=this.projectsForCurrentApp.find(f=>f.id===i);h&&(this.currentProject=h)}}catch{}}setCurrentProjectById(t){var i;if(this.projectsForCurrentApp.length>0){const o=this.projectsForCurrentApp.find(r=>r.id===t);o?this.currentProject=o:this.currentProject=null}else this.$route.params.applicationId===((i=this.currentApp)==null?void 0:i.id)&&!this.isLoadingProjects&&!this.isSwitchingApplication?this.loadProjectsForCurrentApp():this.currentProject=null}async tryAutoSelectAppAndProject(){if(u.allApplications.length===0&&await u.loadAllApplications(),this.isProjectStructuresPage){const t=this.$route.params.applicationId,i=this.$route.params.projectId;await this.setActiveProjectById(t,i)}else if(this.isApplicationDetailsPage||this.isApplicationSettingsPage){const i=this.$route.path.match(/^\/application\/([^/]+)/);if(i){const o=decodeURIComponent(i[1]);await this.setActiveAppById(o)}}}handleClickOutside(t){const i=this.$refs.appDropdownRef,o=this.$refs.projectDropdownRef,r=this.$refs.avatarDropdownRef,d=i&&!i.contains(t.target),h=o&&!o.contains(t.target),f=r&&!r.contains(t.target);this.appDropdownOpen&&d&&(this.appDropdownOpen=!1),this.projectDropdownOpen&&h&&(this.projectDropdownOpen=!1),this.avatarDropdownOpen&&f&&(this.avatarDropdownOpen=!1)}notifyApplicationChange(t){this.$emit("application-changed",t)}};y([B("$route.fullPath",{immediate:!0})],j.prototype,"onRouteChange",1);y([B("APPLICATION_STATE.currentApplication",{immediate:!0})],j.prototype,"onGlobalApplicationChange",1);j=y([N({components:{InputText:O,IconField:L,InputIcon:R}})],j);const Y="/assets/logo-BpfdRTft.svg",H="data:image/svg+xml,%3csvg%20width='28'%20height='38'%20viewBox='0%200%2028%2038'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M14.6278%200.308418C14.0991%20-0.102806%2013.3354%20-0.102806%2012.8067%200.308418L0.176239%209.12036C0.0587463%209.23786%200%209.2966%200%209.41409V12.4689C0%2012.7626%200.293731%2012.9389%200.528717%2012.7626L12.8067%204.24442C13.3354%203.8332%2014.0991%203.8332%2014.6278%204.24442L26.9058%2012.8214C27.1408%2012.9976%2027.4345%2012.8214%2027.4345%2012.5276V9.41409C27.4345%209.2966%2027.3758%209.17911%2027.2583%209.12036L14.6278%200.308418Z'%20fill='%23C8FB39'/%3e%3cpath%20d='M12.8067%207.7104L0.176239%2016.5811C0.0587463%2016.6398%200%2016.7573%200%2016.8748V19.9296C0%2020.2234%200.293731%2020.3996%200.528717%2020.2234L12.7479%2011.6464C13.2767%2011.2352%2014.0404%2011.2352%2014.5691%2011.6464L26.8471%2020.2234C27.082%2020.3996%2027.3758%2020.2234%2027.3758%2019.9296V16.8748C27.3758%2016.7573%2027.317%2016.6398%2027.1995%2016.5811L14.6278%207.7104C14.0991%207.35793%2013.3354%207.35793%2012.8067%207.7104Z'%20fill='%23C8FB39'/%3e%3cpath%20d='M14.6278%2015.1712C14.0991%2014.76%2013.3354%2014.76%2012.8067%2015.1712L0.176239%2023.9832C0.0587463%2024.0419%200%2024.1594%200%2024.2769V27.3317C0%2027.6254%200.293731%2027.8017%200.528717%2027.6254L12.7479%2019.0485C13.2767%2018.6372%2014.0404%2018.6372%2014.5691%2019.0485L19.0338%2022.162C19.21%2022.2795%2019.21%2022.5732%2019.0338%2022.7495L14.6866%2025.8043C14.1579%2026.2155%2013.3942%2026.2155%2012.8654%2025.8043L10.6331%2024.4531C10.5156%2024.3944%2010.3393%2024.3944%2010.2806%2024.4531L8.04824%2025.9805C7.872%2026.098%207.872%2026.3918%208.04824%2026.568L12.8654%2029.7403C13.3942%2030.1515%2014.1579%2030.1515%2014.6866%2029.7403L22.0886%2024.5706C22.2061%2024.5119%2022.3823%2024.5119%2022.4998%2024.5706L24.2035%2025.7455C24.3797%2025.863%2024.3797%2026.1568%2024.2035%2026.333L14.6278%2033.0301C14.0991%2033.4413%2013.3354%2033.4413%2012.8067%2033.0301L5.52215%2027.9779C5.40466%2027.9192%205.22842%2027.9192%205.11093%2027.9779L2.93731%2029.5053C2.76108%2029.6228%202.76108%2029.9165%202.93731%2030.0928L12.8067%2036.9661C13.3354%2037.3773%2014.0991%2037.3773%2014.6278%2036.9661L27.2583%2028.0954C27.3758%2028.0367%2027.4345%2027.9192%2027.4345%2027.8017V24.2181C27.4345%2024.1007%2027.3758%2023.9832%2027.2583%2023.9244L14.6278%2015.1712Z'%20fill='%23C8FB39'/%3e%3c/svg%3e",G="data:image/png;base64,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",X={ref:"headerRef",class:"px-6 py-4 bg-surface-950 flex justify-between items-center sticky top-0 left-0 z-50"},$={class:"flex items-center gap-2 text-white relative"},z={key:0,src:Y,class:"h-8"},W={key:1,src:H,class:"!h-8 !w-8"},q={ref:"appDropdownRef",class:"relative inline-block mr-8"},J={key:0,class:"absolute top-full left-0 mt-1 bg-white rounded shadow-lg w-64 max-h-80 overflow-y-auto z-50 p-2"},Z={class:"w-full mb-2"},_=["onClick"],tt={key:0,class:"pi pi-check text-blue-600"},et={ref:"projectDropdownRef",class:"relative inline-block"},st={key:0,class:"absolute top-full left-0 mt-1 bg-white rounded shadow-lg w-64 max-h-80 overflow-y-auto z-50 p-2"},it={class:"w-full mb-2"},ot=["onClick"],rt={key:0,class:"pi pi-check text-blue-600"},at={ref:"avatarDropdownRef",class:"relative"},nt={key:0,class:"absolute top-full right-0 mt-1 bg-white rounded shadow-lg w-48 z-50"},pt={class:"py-1"};function lt(e,s,t,i,o,r){const d=K("RouterLink"),h=R,f=O,I=L;return c(),l("div",X,[n("div",$,[g(d,{to:"/applications",class:"flex items-center gap-2"},{default:D(()=>[!e.isApplicationDetailsPage&&!e.isProjectStructuresPage&&!e.isApplicationSettingsPage&&!e.isDashboardsPage&&!e.isDataInsightsPage&&!e.isSavedWidgetsPage?(c(),l("img",z)):(c(),l("img",W))]),_:1}),e.isApplicationDetailsPage||e.isProjectStructuresPage||e.isApplicationSettingsPage||e.isDashboardsPage||e.isDataInsightsPage||e.isSavedWidgetsPage?(c(),l(P,{key:0},[s[9]||(s[9]=n("span",{class:"text-surface-400 text-lg"},"/",-1)),n("div",q,[n("button",{onClick:s[0]||(s[0]=(...a)=>e.toggleAppDropdown&&e.toggleAppDropdown(...a)),class:"flex items-center gap-2 text-surface-400 font-medium text-sm hover:opacity-80 w-full justify-between"},[v(C(e.currentAppName)+" ",1),s[6]||(s[6]=n("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19 9l-7 7-7-7"})],-1))]),e.appDropdownOpen?(c(),l("div",J,[n("div",Z,[g(I,{class:"w-full"},{default:D(()=>[g(h,{class:"pi pi-search"}),g(f,{modelValue:e.searchTextApp,"onUpdate:modelValue":s[1]||(s[1]=a=>e.searchTextApp=a),placeholder:"Search applications",class:"w-full"},null,8,["modelValue"])]),_:1})]),(c(!0),l(P,null,b(e.filteredApplications,a=>{var w,m;return c(),l("div",{key:a.id,onClick:x=>e.selectApp(a),class:k(["px-4 py-2 cursor-pointer text-sm rounded flex items-center justify-between",((w=e.currentApp)==null?void 0:w.id)===a.id?"bg-blue-100 text-blue-700 font-medium":"hover:bg-gray-100 text-surface-950"])},[n("span",null,C(a.id),1),((m=e.currentApp)==null?void 0:m.id)===a.id?(c(),l("i",tt)):A("",!0)],10,_)}),128))])):A("",!0)],512),e.currentApp&&!e.isApplicationSettingsPage&&!e.isDashboardsPage&&!e.isDataInsightsPage&&!e.isSavedWidgetsPage?(c(),l(P,{key:0},[s[8]||(s[8]=n("span",{class:"text-surface-400 text-lg"},"/",-1)),n("div",et,[n("button",{onClick:s[2]||(s[2]=(...a)=>e.toggleProjectDropdown&&e.toggleProjectDropdown(...a)),class:"flex items-center gap-2 text-surface-400 font-medium text-sm hover:opacity-80 w-full justify-between"},[v(C(e.currentProjectName)+" ",1),s[7]||(s[7]=n("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19 9l-7 7-7-7"})],-1))]),e.projectDropdownOpen?(c(),l("div",st,[n("div",it,[g(I,{class:"w-full"},{default:D(()=>[g(h,{class:"pi pi-search"}),g(f,{modelValue:e.searchTextProject,"onUpdate:modelValue":s[3]||(s[3]=a=>e.searchTextProject=a),placeholder:"Search projects",class:"w-full"},null,8,["modelValue"])]),_:1})]),(c(!0),l(P,null,b(e.filteredProjects,a=>{var w,m;return c(),l("div",{key:a.id??"",onClick:x=>e.selectProject(a),class:k(["px-4 py-2 cursor-pointer text-sm rounded flex items-center justify-between",((w=e.currentProject)==null?void 0:w.id)===a.id?"bg-blue-100 text-blue-700 font-medium":"hover:bg-gray-100 text-surface-950"])},[n("span",null,C(a.name),1),((m=e.currentProject)==null?void 0:m.id)===a.id?(c(),l("i",rt)):A("",!0)],10,ot)}),128))])):A("",!0)],512)],64)):A("",!0)],64)):A("",!0)]),n("div",at,[n("button",{onClick:s[4]||(s[4]=(...a)=>e.toggleAvatarDropdown&&e.toggleAvatarDropdown(...a)),class:"flex items-center"},s[10]||(s[10]=[n("img",{src:G,class:"h-8 w-8 rounded-full cursor-pointer hover:opacity-80"},null,-1)])),e.avatarDropdownOpen?(c(),l("div",nt,[n("div",pt,[n("button",{onClick:s[5]||(s[5]=(...a)=>e.handleLogout&&e.handleLogout(...a)),class:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center"},s[11]||(s[11]=[n("i",{class:"pi pi-sign-out mr-2"},null,-1),v(" Logout ")]))])])):A("",!0)],512)],512)}const wt=M(j,[["render",lt]]);export{wt as H};
//# sourceMappingURL=Header-Di0n6J9k.js.map
