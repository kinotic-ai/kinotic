var ie=Object.defineProperty;var ne=(e,t,o)=>t in e?ie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var v=(e,t,o)=>ne(e,typeof t!="symbol"?t+"":t,o);import{_ as N,c as R,o as I,f as ae,d as re,g as W,u as le,h as pe,i as de,j as F,b as T,w as A,k as Q,a as i,l as ce,e as g,m as x,T as ue,n as z,p as me,q as fe,s as he,v as C,x as be,A as E,y as ve,t as $,z as we}from"./index-BAuc_XpL.js";import{_ as ye,a as ge,b as Z,c as H}from"./GraphQLModal-CjbDho2T.js";import{_ as Y,s as q,a as J}from"./index-8yU-erlp.js";import{s as Ae}from"./index-Bz44qjX7.js";import{s as _e}from"./index-B0amNHxs.js";import{s as G}from"./index-d3RWyEKF.js";import{_ as K}from"./CrudTable-Dx3WuCAV.js";import{B as xe,a as X,b as Ce,C as Se}from"./component-CLWqUams.js";import{m as Ie,a as Oe}from"./mdi-CBizMyMI.js";import{D as Pe}from"./DatetimeUtil-C1mlUI8S.js";import"./GraphQLPlayground-CDY9kcdH.js";import"./index-BWJDcOuA.js";import"./index-ChDFEGgs.js";import"./index-AFbNaqJX.js";import"./index-g95NevXP.js";import"./index-D9EM4B1w.js";import"./index-DN8o-Nsy.js";import"./index-CqdoTLcK.js";import"./index-2fgv3Tde.js";import"./index-DeH_O1z3.js";const Ee={},$e={class:"max-w-[1200px] mx-auto"};function Te(e,t){return I(),R("div",$e,[ae(e.$slots,"default")])}const ee=N(Ee,[["render",Te]]),Le={key:0,class:"fixed inset-y-0 right-0 w-[400px] h-screen bg-white shadow-xl z-50 overflow-y-auto"},ke={class:"mb-5"},Me={class:"mb-5"},De={class:"border border-[#E6E7EB] rounded-2xl w-full divide-y divide-[#E6E7EB]"},Qe={class:"flex items-center justify-between p-4"},Ge={class:"flex items-center justify-between p-4"},Ve={class:"flex justify-end gap-2 mt-6"},te=re({__name:"ApplicationSidebar",props:{visible:{type:Boolean}},emits:["submit","close"],setup(e,{emit:t}){const o=W("application-sidebar"),a=e,c=t,w=le(),r=pe({name:"",description:"",graphql:!0,openapi:!1}),p=de(!1),l=F(()=>p.value||r.name.trim()==="");function m(h){let s=h.trim().replace(/\s+/g,"-").replace(/[^a-zA-Z0-9._-]/g,"");return/^[a-zA-Z]/.test(s)||(s="app-"+s),s.toLowerCase()}function f(){r.name="",r.description="",r.graphql=!0,r.openapi=!1}async function _(){p.value=!0;try{const h={id:m(r.name),description:r.description,enableGraphQL:r.graphql,enableOpenAPI:r.openapi,updated:null},s=await z.getApplicationService().create(h);w.add({severity:"success",summary:"Success",detail:"Application successfully added",life:3e3}),f(),c("submit",s)}catch(h){o("Failed to create application: %O",h),w.add({severity:"error",summary:"Error",detail:"Failed to create application. Please check name validity.",life:3e3})}finally{p.value=!1}}function u(){f(),c("close")}return(h,s)=>(I(),T(ue,{name:"slide"},{default:A(()=>[a.visible?(I(),R("div",Le,[i("div",{class:"flex justify-between items-center mb-4 border-b border-b-[#E6E7EB] p-4"},[s[5]||(s[5]=i("div",{class:"flex items-center gap-3"},[i("img",{src:ye}),i("h2",{class:"text-lg font-semibold"},"New Application")],-1)),i("span",{onClick:u,class:"w-[11px] h-[11px] cursor-pointer"},s[4]||(s[4]=[i("img",{src:ge},null,-1)]))]),i("form",{onSubmit:ce(_,["prevent"]),class:"flex flex-col h-[calc(100vh-100px)] justify-between gap-4 p-4"},[i("div",null,[i("div",ke,[s[6]||(s[6]=i("label",{class:"block text-sm text-[#101010] mb-3 font-semibold"},"Name",-1)),g(x(Ae),{modelValue:r.name,"onUpdate:modelValue":s[0]||(s[0]=y=>r.name=y),type:"text",class:"w-full",required:""},null,8,["modelValue"])]),i("div",Me,[s[7]||(s[7]=i("label",{class:"block text-sm text-[#101010] mb-3 font-semibold"},"Description",-1)),g(x(_e),{modelValue:r.description,"onUpdate:modelValue":s[1]||(s[1]=y=>r.description=y),class:"w-full",rows:"3"},null,8,["modelValue"])]),i("div",null,[s[10]||(s[10]=i("label",{class:"block text-sm text-[#101010] mb-3 font-semibold"},"API configuration",-1)),i("div",De,[i("div",Qe,[s[8]||(s[8]=i("div",{class:"flex items-center gap-2"},[i("img",{src:Y}),i("span",{class:"text-[#3F424D] text-sm font-normal"},"GraphQL")],-1)),g(x(q),{modelValue:r.graphql,"onUpdate:modelValue":s[2]||(s[2]=y=>r.graphql=y),onLabel:"On",offLabel:"Off"},null,8,["modelValue"])]),i("div",Ge,[s[9]||(s[9]=i("div",{class:"flex items-center gap-2"},[i("img",{src:J}),i("span",{class:"text-[#3F424D] text-sm font-normal"},"OpenAPI")],-1)),g(x(q),{modelValue:r.openapi,"onUpdate:modelValue":s[3]||(s[3]=y=>r.openapi=y),onLabel:"On",offLabel:"Off"},null,8,["modelValue"])])])])]),i("div",Ve,[g(x(G),{type:"button",onClick:u,severity:"secondary",label:"Cancel"}),g(x(G),{type:"submit",disabled:l.value,severity:"primary",label:"Create Application"},null,8,["disabled"])])],32)])):Q("",!0)]),_:1}))}});function qe(e){return fe()?(he(e),!0):!1}const oe=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Be=Object.prototype.toString,Ue=e=>Be.call(e)==="[object Object]",S=()=>{},je=Ne();function Ne(){var e,t;return oe&&((e=window==null?void 0:window.navigator)==null?void 0:e.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((t=window==null?void 0:window.navigator)==null?void 0:t.maxTouchPoints)>2&&/iPad|Macintosh/.test(window==null?void 0:window.navigator.userAgent))}function M(e){return Array.isArray(e)?e:[e]}function Re(e,t,o){return me(e,t,{...o,immediate:!0})}const se=oe?window:void 0;function P(e){var t;const o=C(e);return(t=o==null?void 0:o.$el)!=null?t:o}function D(...e){const t=[],o=()=>{t.forEach(p=>p()),t.length=0},a=(p,l,m,f)=>(p.addEventListener(l,m,f),()=>p.removeEventListener(l,m,f)),c=F(()=>{const p=M(C(e[0])).filter(l=>l!=null);return p.every(l=>typeof l!="string")?p:void 0}),w=Re(()=>{var p,l;return[(l=(p=c.value)==null?void 0:p.map(m=>P(m)))!=null?l:[se].filter(m=>m!=null),M(C(c.value?e[1]:e[0])),M(x(c.value?e[2]:e[1])),C(c.value?e[3]:e[2])]},([p,l,m,f])=>{if(o(),!(p!=null&&p.length)||!(l!=null&&l.length)||!(m!=null&&m.length))return;const _=Ue(f)?{...f}:f;t.push(...p.flatMap(u=>l.flatMap(h=>m.map(s=>a(u,h,s,_)))))},{flush:"post"}),r=()=>{w(),o()};return qe(o),r}let B=!1;function We(e,t,o={}){const{window:a=se,ignore:c=[],capture:w=!0,detectIframe:r=!1,controls:p=!1}=o;if(!a)return p?{stop:S,cancel:S,trigger:S}:S;if(je&&!B){B=!0;const n={passive:!0};Array.from(a.document.body.children).forEach(d=>d.addEventListener("click",S,n)),a.document.documentElement.addEventListener("click",S,n)}let l=!0;const m=n=>C(c).some(d=>{if(typeof d=="string")return Array.from(a.document.querySelectorAll(d)).some(b=>b===n.target||n.composedPath().includes(b));{const b=P(d);return b&&(n.target===b||n.composedPath().includes(b))}});function f(n){const d=C(n);return d&&d.$.subTree.shapeFlag===16}function _(n,d){const b=C(n),k=b.$.subTree&&b.$.subTree.children;return k==null||!Array.isArray(k)?!1:k.some(V=>V.el===d.target||d.composedPath().includes(V.el))}const u=n=>{const d=P(e);if(n.target!=null&&!(!(d instanceof Element)&&f(e)&&_(e,n))&&!(!d||d===n.target||n.composedPath().includes(d))){if("detail"in n&&n.detail===0&&(l=!m(n)),!l){l=!0;return}t(n)}};let h=!1;const s=[D(a,"click",n=>{h||(h=!0,setTimeout(()=>{h=!1},0),u(n))},{passive:!0,capture:w}),D(a,"pointerdown",n=>{const d=P(e);l=!m(n)&&!!(d&&!n.composedPath().includes(d))},{passive:!0}),r&&D(a,"blur",n=>{setTimeout(()=>{var d;const b=P(e);((d=a.document.activeElement)==null?void 0:d.tagName)==="IFRAME"&&!(b!=null&&b.contains(a.document.activeElement))&&t(n)},0)},{passive:!0})].filter(Boolean),y=()=>s.forEach(n=>n());return p?{stop:y,cancel:()=>{l=!1},trigger:n=>{l=!0,u(n),l=!1}}:y}var Fe=Object.defineProperty,ze=Object.getOwnPropertyDescriptor,L=(e,t,o,a)=>{for(var c=a>1?void 0:a?ze(t,o):t,w=e.length-1,r;w>=0;w--)(r=e[w])&&(c=(a?r(t,o,c):r(c))||c);return a&&c&&Fe(t,o,c),c};const U=W("application-list");var j;let O=class extends xe{constructor(){super(...arguments);v(this,"headers",[{field:"id",header:"Name",sortable:!1},{field:"description",header:"Description",sortable:!1},{field:"created",header:"Created",sortable:!1},{field:"updated",header:"Updated",sortable:!1}]);v(this,"dataSource",z.getApplicationService());v(this,"icons",{graph:Oe,api:Ie});v(this,"showGraphQLModal",!1);v(this,"showOpenAPIModal",!1);v(this,"showSidebar",!1);v(this,"searchText",((j=this==null?void 0:this.$route)==null?void 0:j.query.search)||"");v(this,"itemCount",0);v(this,"sidebarWrapper");v(this,"crudTable");v(this,"DatetimeUtil",Pe)}async mounted(){var t;try{this.refreshTable();const o=be(this.sidebarWrapper);We(o,()=>{this.showSidebar&&this.onSidebarClose()}),((t=this==null?void 0:this.$route)==null?void 0:t.query.created)==="true"&&this.$router.replace({query:{}})}catch(o){const a=o instanceof Error?o.message:"Unknown error";U("Initialization error: %s",a)}}onRouteSearchQueryChanged(t){this.searchText=t||""}refreshTable(){var t;(t=this.crudTable)==null||t.find()}onItemsCount(t){this.itemCount=t}updateRouteQuery(t){var a;const o={...(a=this==null?void 0:this.$route)==null?void 0:a.query};t?o.search=t:delete o.search,this.$router.replace({query:o})}get shouldShowPagination(){return this.itemCount>3}onAddItem(){this.showSidebar=!0}async toApplicationPage(t){try{const o=t.id??"",a=await this.dataSource.findById(o);E.currentApplication=a,this.$router.push(`/application/${encodeURIComponent(o)}`)}catch(o){U("Failed to navigate to application: %O",o)}}onSidebarClose(){this.showSidebar=!1}onApplicationSubmit(t){t&&t.id&&(E.allApplications.some(a=>a.id===t.id)||(E.allApplications=[t,...E.allApplications])),this.refreshTable(),this.showSidebar=!1}onEditItem(t){this.$router.push(`${this.$route.path}/edit/${t.id}`)}openGraphQL(){this.showGraphQLModal=!0}closeGraphQL(){this.showGraphQLModal=!1}openOpenAPI(){this.showOpenAPIModal=!0}closeOpenAPI(){this.showOpenAPIModal=!1}};L([X("sidebarWrapper")],O.prototype,"sidebarWrapper",2);L([X("crudTable")],O.prototype,"crudTable",2);L([Ce("$route.query.search")],O.prototype,"onRouteSearchQueryChanged",1);O=L([Se({components:{CrudTable:K,ContainerMedium:ee,ApplicationSidebar:te,GraphQLModal:H,OpenAPIModal:Z}})],O);const Ze={class:"block max-w-[300px] sm:max-w-[500px] md:max-w-[190px] lg:max-w-[390px] xl:max-w-[590px] truncate"},He={ref:"sidebarWrapper"};function Ye(e,t,o,a,c,w){const r=G,p=K,l=H,m=Z,f=te,_=ee;return I(),T(_,null,{default:A(()=>[t[2]||(t[2]=i("h1",{class:"text-2xl font-semibold mb-5 text-surface-950"},"Applications",-1)),g(p,{ref:"crudTable",createNewButtonText:"New application",rowHoverColor:"","data-source":e.dataSource,headers:e.headers,singleExpand:!1,enableViewSwitcher:!0,emptyStateText:"No applications yet",search:e.searchText,"onUpdate:search":e.updateRouteQuery,onAddItem:e.onAddItem,onEditItem:e.onEditItem,onOnRowClick:e.toApplicationPage,class:"!text-sm","show-pagination":!1},{"item.id":A(({item:u})=>[i("span",null,$(u.id),1)]),"item.description":A(({item:u})=>[i("span",Ze,$(u.description),1)]),"item.created":A(({item:u})=>[i("span",null,$(e.DatetimeUtil.formatMonthDayYear(u.created)),1)]),"item.updated":A(({item:u})=>[i("span",null,$(e.DatetimeUtil.formatRelativeDate(u.updated)),1)]),"additional-actions":A(({item:u})=>[u.enableGraphQL?(I(),T(r,{key:0,text:"",title:"GraphQL",onClick:e.openGraphQL},{default:A(()=>t[0]||(t[0]=[i("img",{class:"!w-[24px] !h-[24px]",src:Y},null,-1)])),_:1,__:[0]},8,["onClick"])):Q("",!0),u.enableOpenAPI?(I(),T(r,{key:1,text:"",title:"OpenAPI",onClick:e.openOpenAPI},{default:A(()=>t[1]||(t[1]=[i("img",{class:"!w-[24px] !h-[24px]",src:J},null,-1)])),_:1,__:[1]},8,["onClick"])):Q("",!0)]),_:1},8,["data-source","headers","search","onUpdate:search","onAddItem","onEditItem","onOnRowClick"]),g(l,{visible:e.showGraphQLModal,onClose:e.closeGraphQL},null,8,["visible","onClose"]),g(m,{visible:e.showOpenAPIModal,onClose:e.closeOpenAPI},null,8,["visible","onClose"]),ve(i("div",He,[g(f,{visible:e.showSidebar,onClose:e.onSidebarClose,onSubmit:e.onApplicationSubmit},null,8,["visible","onClose","onSubmit"])],512),[[we,e.showSidebar]])]),_:1,__:[2]})}const wt=N(O,[["render",Ye],["__scopeId","data-v-3cb9b90d"]]);export{wt as default};
//# sourceMappingURL=ApplicationList-DVjw0tb3.js.map
